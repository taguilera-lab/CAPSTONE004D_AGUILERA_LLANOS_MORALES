{% extends 'base.html' %}
{% load static %}

{% block title %}Lista de Ingresos{% endblock %}

{% block content %}
<div class="container mt-4">
  <h1 class="mb-4">Lista de Ingresos</h1>
  <a href="{% url 'ingreso_create_select' %}" class="btn btn-primary mb-3">Crear Nuevo Ingreso</a>
  <a href="{% url 'registrar_salida' %}" class="btn btn-secondary mb-3">Registrar Salida</a>
  <a href="{% url 'calendario' %}" class="btn btn-info mb-3">Ver Calendario</a>
  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>Patente</th>
          <th>Servicio</th>
          <th>Entrada</th>
          <th>Salida</th>
          <th>Chofer</th>
          <th>Sucursal</th>
          <th>Agendado</th>
          <th>Autorización</th>
          <th>Entrada Registrada Por</th>
          <th>Salida Registrada Por</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for ingreso in ingresos %}
        <tr>
          <td>{{ ingreso.id_ingreso }}</td>
          <td>{{ ingreso.patent }}</td>
          <td>{{ ingreso.service_type }}</td>
          <td>{{ ingreso.entry_datetime }}</td>
          <td>{{ ingreso.exit_datetime|default:"-" }}</td>
          <td>{{ ingreso.chofer }}</td>
          <td>{{ ingreso.patent.site.name }}</td>
          <td>
            {% if ingreso.schedule %}
              <span class="badge bg-info">Agendado</span>
            {% else %}
              <span class="badge bg-secondary">Directo</span>
            {% endif %}
          </td>
          <td>
            {% if ingreso.authorization %}
              <span class="badge bg-success">Sí</span>
            {% else %}
              <span class="badge bg-danger">No</span>
            {% endif %}
          </td>
          <td>{{ ingreso.entry_registered_by|default:"-" }}</td>
          <td>{{ ingreso.exit_registered_by|default:"-" }}</td>
          <td><a href="{% url 'ingreso_detail' ingreso.id_ingreso %}" class="btn btn-sm btn-info">Ver</a></td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}