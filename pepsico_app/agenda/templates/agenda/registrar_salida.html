{% extends 'base.html' %}
{% load static %}

{% block title %}Registrar Salida{% endblock %}

{% block static %}
<link rel="stylesheet" href="{% static 'agenda/css/formulario.css' %}">
<link rel="stylesheet" href="{% static 'agenda/css/registrar_salida.css' %}">
{% endblock %}

{% block content %}
<div class="contenedor">
  <div class="formulario">
    <h2>Registrar Salida de Camión</h2>

    {% if error %}
    <div class="error-alert">
      {{ error }}
    </div>
    {% endif %}

    {% if ingresos_pendientes %}
    <form method="post">
      {% csrf_token %}
      <div class="campo">
        <label for="ingreso">Seleccionar Ingreso:</label>
        <select name="ingreso" id="ingreso" class="custom-select" required>
          <option value="">---------</option>
          {% for ingreso in ingresos_pendientes %}
          <option value="{{ ingreso.id_ingreso }}">{{ ingreso.patent }} - {{ ingreso.service_type }} (Fin: {{ ingreso.observations|default:"-" }}, Entrada: {{ ingreso.entry_datetime }})</option>
          {% endfor %}
        </select>
      </div>
      <div class="campo">
        <label for="exit_datetime">Fecha y Hora de Salida:</label>
        <input type="datetime-local" name="exit_datetime" id="exit_datetime" class="custom-datetime" required>
      </div>
      <div class="campo">
        <div class="checkbox-container">
          <input type="checkbox" name="autorizar" id="autorizar">
          <label for="autorizar">Autorizar salida (confirmar revisión de correo con patente y fin de mantención)</label>
        </div>
      </div>
      <br>
      <div class="botones">
        <button type="submit" class="btn-programar">Registrar Salida</button>
      </div>
    </form>
    {% else %}
    <div class="info-alert">
      No hay ingresos pendientes de salida.
    </div>
    {% endif %}
    <br>
    <div class="botones">
      <a href="{% url 'ingresos_list' %}" class="btn-programar" style="background-color: #6c757d;">Volver a Lista de Ingresos</a>
    </div>
  </div>
</div>
{% endblock %}