{% extends 'base.html' %}
{% load static %}

{% block title %}Reportar Incidente - Guardia{% endblock %}

{% block static %}
<link rel="stylesheet" href="{% static 'incidents/css/guardia_report.css' %}">
{% endblock %}

{% block content %}
<div class="contenedor">
    <div class="formulario">
        <h2>Reportar Incidente (Guardia)</h2>
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{ form.as_p }}

            <!-- Sección de imágenes -->
            <div class="form-group">
                <label>Imágenes del incidente (opcional):</label>

                <!-- Contenedor de cámara -->
                <div class="camera-container">
                    <video id="camera-preview" class="camera-preview" autoplay playsinline></video>
                    <canvas id="camera-canvas" style="display: none;"></canvas>

                    <div class="camera-controls">
                        <button type="button" id="start-camera" class="btn-camera">
                            <i class="fas fa-camera"></i> Activar Cámara
                        </button>
                        <button type="button" id="capture-photo" class="btn-capture" style="display: none;">
                            <i class="fas fa-camera-retro"></i> Tomar Foto
                        </button>
                        <button type="button" id="stop-camera" class="btn-camera" style="display: none;">
                            <i class="fas fa-stop"></i> Detener Cámara
                        </button>
                    </div>

                    <div class="captured-images" id="captured-images"></div>
                </div>

                <!-- Campo oculto para las imágenes capturadas -->
                <input type="file" name="camera_images" id="camera-images-input" multiple style="display: none;" accept="image/*">

                <small class="form-text text-muted">
                    Use la cámara para tomar fotos del incidente. Las imágenes se subirán automáticamente.
                </small>
            </div>

            <div class="botones">
                <button type="submit" class="btn-programar">Reportar</button>
            </div>
        </form>
    </div>
</div>

<script src="{% static 'incidents/js/guardia_report.js' %}"></script>
{% endblock %}